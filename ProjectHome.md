Most of the code are from my class